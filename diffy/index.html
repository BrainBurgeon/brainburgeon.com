<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>diffy</title>
  <style>[v-cloak] { display: none; }</style>
  <script type="text/javascript" src="./js/xlsx.core.min.js" async></script>
  <script type="text/javascript" src="./js/vue.global.prod.js" async></script>
</head>
<body>

  <div id="app">
    <div v-if="!loaded">Loading...</div>

    <main v-if="files.A.selectedCell && files.B.selectedCell">
      <Diff :file_a="files.A" :file_b="files.B"></Diff>
    </main>
    <main v-else v-cloak>
      <Excel label="A"></Excel>
      <Excel label="B"></Excel>
    </main>

    <footer v-cloak>
      <small>v{{version}}</small>
    </footer>
  </div>

  <script>
    window.config = {
      version: '1.0.6'
    }
    window.onload = function() {
      var link = document.createElement('link')
      link.href = './styles.css?c=' + window.config.version
      link.rel = 'stylesheet'
      document.head.appendChild(link)
      
      var script = document.createElement('script')
      script.src = './js/app.js?c=' + window.config.version
      script.type = 'text/javascript'
      document.head.appendChild(script)
    }
  </script>
  
</body>
</html>